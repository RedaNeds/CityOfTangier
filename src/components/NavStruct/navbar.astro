
---
// Navbar component
---

<nav id="navbar" class="navbar" role="navigation" aria-label="Main navigation">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="flex justify-between items-center h-16">
			<!-- Logo and Brand -->
			<div class="flex items-center">
				<a href="/" class="flex items-center space-x-2 hover:opacity-80 transition-opacity" aria-label="City of Tangier - Home">
					<div class="w-8 h-8 bg-strait-blue rounded flex items-center justify-center" aria-hidden="true">
						<span class="text-white font-bold text-sm">T</span>
					</div>
					<h1 class="text-xl font-bold text-ink font-headline">City Of Tangier</h1>
				</a>
			</div>

			<!-- Desktop Navigation -->
			<div class="hidden md:block">
				<ul class="ml-10 flex items-baseline space-x-6" role="menubar">
					<li role="none"><a href="/discover/attractions" class="text-slate hover:text-strait-blue px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-strait-blue focus:ring-offset-2 rounded" role="menuitem">Attractions</a></li>
					<li role="none"><a href="/discover/restaurants" class="text-slate hover:text-strait-blue px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-strait-blue focus:ring-offset-2 rounded" role="menuitem">Restaurants</a></li>
					<li role="none"><a href="/neighborhoods" class="text-slate hover:text-strait-blue px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-strait-blue focus:ring-offset-2 rounded" role="menuitem">Neighborhoods</a></li>
					<li role="none"><a href="/events" class="text-slate hover:text-strait-blue px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-strait-blue focus:ring-offset-2 rounded" role="menuitem">Events</a></li>
					<li role="none"><a href="/itineraries" class="text-slate hover:text-strait-blue px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-strait-blue focus:ring-offset-2 rounded" role="menuitem">Itineraries</a></li>
					<li role="none"><a href="/guides" class="text-slate hover:text-strait-blue px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-strait-blue focus:ring-offset-2 rounded" role="menuitem">Guides</a></li>
				</ul>
			</div>

			<!-- Search and Mobile Menu -->
			<div class="flex items-center space-x-4">
				<!-- Search Button -->
				<button id="search-toggle" class="text-slate hover:text-strait-blue transition-colors">
					<svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
					</svg>
				</button>

				<!-- Mobile Menu Button -->
				<button id="mobile-menu-toggle" class="md:hidden text-slate hover:text-strait-blue transition-colors">
					<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
				</button>
			</div>
		</div>

		<!-- Mobile Menu -->
		<div id="mobile-menu" class="md:hidden hidden">
			<div class="px-2 pt-2 pb-3 space-y-1 bg-surface border-t border-border">
				<a href="/discover/attractions" class="block px-3 py-2 text-slate hover:text-strait-blue hover:bg-sand rounded-md text-base font-medium">Attractions</a>
				<a href="/discover/restaurants" class="block px-3 py-2 text-slate hover:text-strait-blue hover:bg-sand rounded-md text-base font-medium">Restaurants</a>
				<a href="/neighborhoods" class="block px-3 py-2 text-slate hover:text-strait-blue hover:bg-sand rounded-md text-base font-medium">Neighborhoods</a>
				<a href="/events" class="block px-3 py-2 text-slate hover:text-strait-blue hover:bg-sand rounded-md text-base font-medium">Events</a>
				<a href="/itineraries" class="block px-3 py-2 text-slate hover:text-strait-blue hover:bg-sand rounded-md text-base font-medium">Itineraries</a>
				<a href="/guides" class="block px-3 py-2 text-slate hover:text-strait-blue hover:bg-sand rounded-md text-base font-medium">Guides</a>
			</div>
		</div>
	</div>

	<!-- Search Overlay -->
	<div id="search-overlay" class="search-overlay" style="display: none;">
		<div class="search-container">
			<div class="max-w-2xl mx-auto px-4">
				<div class="relative">
					<input 
						type="text" 
						id="search-input"
						placeholder="Search places, events, guides..." 
						class="w-full px-4 py-4 pr-14 text-lg border border-[#F0F0F0] rounded-search focus:outline-none focus:ring-2 focus:ring-strait-blue bg-surface text-ink placeholder-slate"
					>
					<button id="search-close" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate hover:text-ink p-1 z-10">
						<svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
						</svg>
					</button>
				</div>
				
				<!-- Search Results -->
				<div id="search-results" class="mt-6 bg-surface rounded-card border border-[#F0F0F0] max-h-96 overflow-y-auto hidden">
					<div class="p-4">
						<div class="text-sm text-slate mb-3">Search Results</div>
						<div id="search-results-list" class="space-y-2">
							<!-- Search results will be populated here -->
						</div>
					</div>
				</div>

				<!-- Quick Links -->
				<div class="mt-6">
					<div class="text-sm text-slate mb-3">Quick Links</div>
					<div class="grid grid-cols-2 md:grid-cols-5 gap-3">
						<a href="/discover/attractions" class="p-3 bg-surface rounded-card border border-[#F0F0F0] transition-all text-center">
							<div class="text-2xl mb-1">üéØ</div>
							<div class="text-sm font-medium text-slate">Attractions</div>
						</a>
						<a href="/discover/restaurants" class="p-3 bg-surface rounded-card border border-[#F0F0F0] transition-all text-center">
							<div class="text-2xl mb-1">üçΩÔ∏è</div>
							<div class="text-sm font-medium text-slate">Restaurants</div>
						</a>
						<a href="/neighborhoods" class="p-3 bg-surface rounded-card border border-[#F0F0F0] transition-all text-center">
							<div class="text-2xl mb-1">üèòÔ∏è</div>
							<div class="text-sm font-medium text-slate">Neighborhoods</div>
						</a>
						<a href="/events" class="p-3 bg-surface rounded-card border border-[#F0F0F0] transition-all text-center">
							<div class="text-2xl mb-1">üéâ</div>
							<div class="text-sm font-medium text-slate">Events</div>
						</a>
						<a href="/guides" class="p-3 bg-surface rounded-card border border-[#F0F0F0] transition-all text-center">
							<div class="text-2xl mb-1">üìö</div>
							<div class="text-sm font-medium text-slate">Guides</div>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</nav>

<style>
	.navbar {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		background: rgba(255, 255, 255, 0.95);
		backdrop-filter: blur(10px);
		z-index: 50;
		transition: all 0.3s ease;
		transform: translateY(0);
	}

	.navbar.hidden {
		transform: translateY(-100%);
	}

	.navbar.scrolled {
		background: rgba(255, 255, 255, 0.98);
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
	}

	.search-overlay {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		width: 100vw;
		height: 100vh;
		background: rgba(0, 0, 0, 0.5);
		backdrop-filter: blur(4px);
		z-index: 9999;
		display: flex;
		align-items: flex-start;
		justify-content: center;
		padding-top: 20vh;
		overflow: hidden;
	}

	.search-container {
		width: 100%;
		animation: slideDown 0.3s ease;
	}

	@keyframes slideDown {
		from {
			opacity: 0;
			transform: translateY(-20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	@media (max-width: 768px) {
		.search-overlay {
			padding-top: 10vh;
		}
	}

	/* Ensure search overlay is above everything */
	.search-overlay * {
		position: relative;
		z-index: 10000;
	}

	/* Prevent body scroll when search is open */
	body.search-open {
		overflow: hidden;
		position: fixed;
		width: 100%;
	}

	/* Ensure overlay covers entire viewport */
	.search-overlay::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: rgba(0, 0, 0, 0.5);
		backdrop-filter: blur(4px);
		z-index: -1;
	}

	/* Ensure X button is properly visible */
	#search-close {
		position: absolute !important;
		right: 12px !important;
		top: 50% !important;
		transform: translateY(-50%) !important;
		z-index: 20 !important;
		background: rgba(255, 255, 255, 0.9);
		border-radius: 50%;
		width: 32px;
		height: 32px;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.2s ease;
	}

	#search-close:hover {
		background: rgba(255, 255, 255, 1);
		transform: translateY(-50%) scale(1.1);
	}
</style>

<script>
	// Wait for DOM to be ready
	document.addEventListener('DOMContentLoaded', function() {
		// Navbar scroll behavior
		let lastScrollY = window.scrollY;
		let ticking = false;

		function updateNavbar() {
			const navbar = document.getElementById('navbar');
			if (!navbar) return;
			
			const currentScrollY = window.scrollY;

			if (currentScrollY > 100) {
				navbar.classList.add('scrolled');
			} else {
				navbar.classList.remove('scrolled');
			}

			// Hide navbar when scrolling down, show when scrolling up
			if (currentScrollY > lastScrollY && currentScrollY > 100) {
				navbar.classList.add('hidden');
			} else {
				navbar.classList.remove('hidden');
			}

			lastScrollY = currentScrollY;
			ticking = false;
		}

		function requestTick() {
			if (!ticking) {
				requestAnimationFrame(updateNavbar);
				ticking = true;
			}
		}

		window.addEventListener('scroll', requestTick);

		// Mobile menu toggle
		const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
		const mobileMenu = document.getElementById('mobile-menu');

		if (mobileMenuToggle && mobileMenu) {
			mobileMenuToggle.addEventListener('click', () => {
				mobileMenu.classList.toggle('hidden');
			});
		}

		// Search functionality
		const searchToggle = document.getElementById('search-toggle');
		const searchOverlay = document.getElementById('search-overlay');
		const searchClose = document.getElementById('search-close');
		const searchInput = document.getElementById('search-input');
		const searchResults = document.getElementById('search-results');
		const searchResultsList = document.getElementById('search-results-list');

		// Mock search data
		const searchData = [
			{ title: 'Kasbah Museum', url: '/discover/attractions/kasbah-museum', type: 'Museum', description: 'Historic palace with stunning views' },
			{ title: 'Caf√© Hafa', url: '/discover/restaurants/cafe-hafa', type: 'Caf√©', description: 'Legendary caf√© with sea views' },
			{ title: 'Tangier in 24 Hours', url: '/itineraries/tangier-in-24-hours', type: 'Itinerary', description: 'Perfect one-day itinerary' },
			{ title: 'Money & Tipping Guide', url: '/practical/money-tipping', type: 'Guide', description: 'Everything about currency and tips' },
			{ title: 'Rooftops in Tangier', url: '/discover/restaurants/categories/rooftops', type: 'Places', description: 'Best rooftop bars and restaurants' },
			{ title: 'Tanjazz Festival', url: '/events/tanjazz', type: 'Event', description: 'International jazz festival' },
			{ title: 'Hercules Caves', url: '/discover/attractions/hercules-caves', type: 'Attraction', description: 'Legendary cave with ocean views' },
			{ title: 'Transportation Guide', url: '/practical/taxis', type: 'Guide', description: 'Getting around Tangier' },
			{ title: 'Kasbah', url: '/neighborhoods/kasbah', type: 'Neighborhood', description: 'Ancient fortress district with museums and views' },
			{ title: 'Marshan', url: '/neighborhoods/marshan', type: 'Neighborhood', description: 'Elegant residential area with colonial architecture' },
			{ title: 'Medina', url: '/neighborhoods/medina', type: 'Neighborhood', description: 'Traditional old town with souks and culture' },
			{ title: 'City Center', url: '/neighborhoods/city-center', type: 'Neighborhood', description: 'Modern commercial heart of Tangier' },
			{ title: 'Malabata', url: '/neighborhoods/malabata', type: 'Neighborhood', description: 'Coastal area with beaches and seaside promenades' }
		];

		function performSearch(query) {
			if (!searchResults || !searchResultsList) return;
			
			if (query.length < 2) {
				searchResults.classList.add('hidden');
				return;
			}

			const results = searchData.filter(item => 
				item.title.toLowerCase().includes(query.toLowerCase()) ||
				item.description.toLowerCase().includes(query.toLowerCase()) ||
				item.type.toLowerCase().includes(query.toLowerCase())
			);

			if (results.length > 0) {
				searchResultsList.innerHTML = results.map(item => `
					<a href="${item.url}" class="block p-3 hover:bg-sand rounded-lg transition-colors">
						<div class="flex items-start space-x-3">
							<div class="flex-shrink-0">
								<div class="w-8 h-8 bg-seafoam/20 rounded-full flex items-center justify-center">
									<span class="text-strait-blue text-sm">${getTypeIcon(item.type)}</span>
								</div>
							</div>
							<div class="flex-1 min-w-0">
								<div class="text-sm font-medium text-ink">${item.title}</div>
								<div class="text-xs text-slate">${item.type}</div>
								<div class="text-xs text-slate mt-1">${item.description}</div>
							</div>
						</div>
					</a>
				`).join('');
				searchResults.classList.remove('hidden');
			} else {
				searchResultsList.innerHTML = `
					<div class="p-4 text-center text-slate">
						<div class="text-sm">No results found for "${query}"</div>
						<div class="text-xs mt-1">Try different keywords</div>
					</div>
				`;
				searchResults.classList.remove('hidden');
			}
		}

		function getTypeIcon(type) {
			const icons = {
				'Museum': 'üèõÔ∏è',
				'Caf√©': '‚òï',
				'Itinerary': 'üó∫Ô∏è',
				'Guide': 'üìö',
				'Places': 'üìç',
				'Event': 'üéâ',
				'Attraction': 'üéØ',
				'Neighborhood': 'üèòÔ∏è'
			};
			return icons[type] || 'üìç';
		}

		function openSearch() {
			if (searchOverlay) {
				searchOverlay.style.display = 'flex';
				document.body.classList.add('search-open');
				setTimeout(() => {
					if (searchInput) searchInput.focus();
				}, 100);
			}
		}

		function closeSearch() {
			if (searchOverlay) searchOverlay.style.display = 'none';
			if (searchInput) searchInput.value = '';
			if (searchResults) searchResults.classList.add('hidden');
			document.body.classList.remove('search-open');
		}

		// Search event listeners
		if (searchToggle && searchOverlay && searchInput) {
			searchToggle.addEventListener('click', (e) => {
				e.preventDefault();
				e.stopPropagation();
				openSearch();
			});
		}

		if (searchClose) {
			searchClose.addEventListener('click', (e) => {
				e.preventDefault();
				e.stopPropagation();
				closeSearch();
			});
		}

		if (searchOverlay) {
			searchOverlay.addEventListener('click', (e) => {
				if (e.target === searchOverlay) {
					closeSearch();
				}
			});
		}

		if (searchInput) {
			searchInput.addEventListener('input', (e) => {
				performSearch(e.target.value);
			});
		}

		// Close search on Escape key
		document.addEventListener('keydown', (e) => {
			if (e.key === 'Escape' && searchOverlay && searchOverlay.style.display !== 'none') {
				closeSearch();
			}
		});
	});
</script>
